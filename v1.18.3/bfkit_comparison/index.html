<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Comparison with traditional continuation &amp; bifurcation software · Attractors.jl</title><meta name="title" content="Comparison with traditional continuation &amp; bifurcation software · Attractors.jl"/><meta property="og:title" content="Comparison with traditional continuation &amp; bifurcation software · Attractors.jl"/><meta property="twitter:title" content="Comparison with traditional continuation &amp; bifurcation software · Attractors.jl"/><meta name="description" content="Documentation for Attractors.jl."/><meta property="og:description" content="Documentation for Attractors.jl."/><meta property="twitter:description" content="Documentation for Attractors.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Attractors.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Attractors.jl</a></li><li><a class="tocitem" href="../tutorial/">Attractors.jl Tutorial</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../examples/">Examples for Attractors.jl</a></li><li class="is-active"><a class="tocitem" href>Comparison with traditional continuation &amp; bifurcation software</a><ul class="internal"><li><a class="tocitem" href="#BifurcationKit.jl-version"><span>BifurcationKit.jl version</span></a></li><li><a class="tocitem" href="#Attractors.jl-version"><span>Attractors.jl version</span></a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Comparison with traditional continuation &amp; bifurcation software</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Comparison with traditional continuation &amp; bifurcation software</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/Attractors.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/Attractors.jl/blob/main/docs/src/bfkit_comparison.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Comparison-with-traditional-continuation-and-bifurcation-software"><a class="docs-heading-anchor" href="#Comparison-with-traditional-continuation-and-bifurcation-software">Comparison with traditional continuation &amp; bifurcation software</a><a id="Comparison-with-traditional-continuation-and-bifurcation-software-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison-with-traditional-continuation-and-bifurcation-software" title="Permalink"></a></h1><div class="admonition is-info"><header class="admonition-header">Continues from tutorial</header><div class="admonition-body"><p>This page continues after the end of the main Tutorial! Ensure you have gon through it first!</p></div></div><p>As we discussed in the subsection on global continuation, the approach of Attractors.jl is fundamentally different from traditional continuation and bifurcation software like AUTO, MatCont, BifurcationKit.jl. Nevertheless in this page we will compare using BifurcationKit.jl to attempt to find and continue the limit cycle of the tutorial modified Lorenz-like system. We forfeit looking for the chaotic attractors, as to our knowledge there exists no software on dynamical systems# beyond Attractors.jl can find chaotic attractors.</p><p>The goal of this comparison is to highlight the differences in usage complexity and overall capability when using Attractors.jl or traditional continuation tools to study <strong>complex</strong> dynamical systems.</p><h2 id="BifurcationKit.jl-version"><a class="docs-heading-anchor" href="#BifurcationKit.jl-version">BifurcationKit.jl version</a><a id="BifurcationKit.jl-version-1"></a><a class="docs-heading-anchor-permalink" href="#BifurcationKit.jl-version" title="Permalink"></a></h2><p>To use BifurcationKit.jl (BK) for periodic orbits (POs) we need to choose one of its several Newton-based algorithms for POs, and in addition supply it with both an initial guess for the location of the periodic orbit, as well as a guess for the period. In this example we translate almost verbatim the example of the <a href="https://bifurcationkit.github.io/BifurcationKitDocs.jl/v0.3/tutorials/ode/tutorialsCodim2PO/#Periodic-predator-prey-model">Periodic predator prey model</a>). from the BK docs. Finding a periodic orbit this way is already considered an advanced use case in BK documentation, requiring &quot;high level of knowledge of (numerical) bifurcation theory&quot;. For Attractors.jl on the other hand, this is as basic of a use-case as it can get, which highlights the simplicity of our computational approach.</p><p>To use BK we need to import it and initialize various continuation-related structures. The key structure is the <code>ShootingProblem</code>, which is a &quot;problem type&quot; that utilizes a multiple shooting method to find periodic orbits (see BK docs). The entire input BK requires to find a periodic orbit is:</p><ol><li>a periodic orbit problem like <code>BK.ShootingProblem</code> or <code>BK.PeriodicOrbitTrapProblem</code> (and its meta parameters)</li><li>a <code>BK.BifurcationProblem</code></li><li>a <code>DifferentialEquations.Solution</code></li><li>an estimate of the period</li><li>a <code>BK.ContinuationPar</code> parameter container</li><li>a predictor for the continuation</li><li>arguments for what aspect of the periodic orbit to record.</li></ol><p>Some of this input isn&#39;t particularly important, but some of it is can be crucial and the values of the meta-parameters matter for whether the continuation will succeed or not.</p><p>Let&#39;s start with the bifurcation problem. This is basically the same thing as a <code>DynamicalSystem</code>, but BK does not support efficient <code>StaticVector</code>-based out of place format for low dimensional systems (see main tutorial of DynamicalSystems.jl if you don&#39;t understand what this means). So we have to re-create</p><pre><code class="language-julia hljs"># BK requires to modify the rule with t=0 as well
function modified_lorenz_rule!(du, u, p, t = 0)
    x, y, z = u; a, b = p
    du[1] = y - x
    du[2] = - x*z + b*abs(z)
    du[3] = x*y - a
    return du
end
prange = 4.7:0.02:6
pidx = 1
p0 = [5.0, 0.1] # parameters
u0 = [-4.0, 5, 0] # state</code></pre><p>Now we can create the bifurcation problem</p><pre><code class="language-julia hljs">import BifurcationKit as BK
using OrdinaryDiffEq

bf_prob = BK.BifurcationProblem(
    modified_lorenz_rule!, u0, p0, (BK.@lens _[pidx])
)</code></pre><p>Then the algorithm particularly for periodic orbits</p><pre><code class="language-julia hljs">periodic_orbit_algo = BK.ShootingProblem(M = 5)</code></pre><p>and then a full solution structure from DifferentialEquations.jl, that <strong>must</strong> start on the periodic orbit. Requiring that the solution starts on the periodic orbit defeats the purpose of &quot;wanting to find it&quot;, but oh well, we do as we must.</p><pre><code class="language-julia hljs"># point_on_lc = Vector(attractors_cont[1][1][end]) # we copy paste the guess below
point_on_lc = [
    -1.622956992666447,
    -4.527917984019188,
    -5.178825669659272,
]

ode_prob = ODEProblem(modified_lorenz_rule!, point_on_lc, (0.0, 100.0), p0)
sol = OrdinaryDiffEq.solve(ode_prob; alg = Vern9(), abstol = 1e-9, reltol = 1e-9)
lines(sol.t, sol[1, :])</code></pre><p>We need an estimate of the period besides providing the full DifferentialEquations.jl solution. From the figure this appears to be around 20.0 (note: the periodic orbit wraps around four times before repeating exactly).</p><p>Right, and lastly we need a continuation parameter container, which has some options regarding convergence and stability that one would need to fine tune to the problem at hand.</p><pre><code class="language-julia hljs">opts_br = BK.ContinuationPar(
    p_min = prange[1], p_max = prange[end],
    ds = 0.002, dsmax = 0.01, n_inversion = 6,
    detect_bifurcation = 3, max_bisection_steps = 25, nev = 4,
    max_steps = 2000, tol_stability = 1e-3
)</code></pre><p>Now we put everything together in</p><pre><code class="language-julia hljs">probsh, cish = BK.generate_ci_problem(
    periodic_orbit_algo, bf_prob, ode_prob, sol, 20.0; alg = Vern9(), maxiters = Int(1e6),
)</code></pre><p>To call the continuation we need to also tell it what aspects of the periodic orbit to record, so we define</p><pre><code class="language-julia hljs">argspo = (record_from_solution = (x, p) -&gt; begin
		xtt = get_periodic_orbit(p.prob, x, p.p)
		return (max = maximum(xtt[1,:]),
				min = minimum(xtt[1,:]),
				period = getperiod(p.prob, x, p.p))
	end,
)</code></pre><p>we also define the predictor</p><pre><code class="language-julia hljs">predictor = BK.PALC(tangent = BK.Bordered())</code></pre><p>and <em>finally</em> call the continuation from BK</p><pre><code class="language-julia hljs">br_fold_sh = BK.continuation(probsh, cish, predictor, opts_br;
    verbosity = 3, plot = false,
    argspo...
)</code></pre><p>The above code takes a good 30 seconds to run, but unfortunately <strong>it fails</strong>. During the evaluation we get lots of warnings of the type</p><pre><code class="language-julia-repl hljs">┌ Warning: Interrupted. Larger maxiters is needed.
If you are using an integrator for non-stiff ODEs or an automatic switching
algorithm (the default), you may want to consider using a method for stiff equations.
See the solver pages for more details (e.g. https://docs.sciml.ai/DiffEqDocs/stable/solvers/ode_solve/#Stiff-Problems).</code></pre><p>which actually, have nothing to do with our solver not being stiff. What happens here is that the Newton algorithm used to find periodic orbits never converges. This is almost surely because these Newton-based periodic orbit algorithms fail to converge in the presence of chaos, and the periodic orbit we try to find here starts without chaos, but continues to exist while chaos exists, hence the continuation fails. One could try to fine-tune the parameters in <code>BK.ContinuationPar</code> or in <code>BK.ShootingProblem</code>, but some small changes we&#39;ve tried while composing this page didn&#39;t work. (Also Attractors.jl just works without fine tuning so we gave up quite quickly). If you know some bifurcation software that can actually find this limit cycle, sends us a message. We are happy to cite it!</p><p>We could stop searching <em>before</em> chaos starts, to make the convergence easier. But, since BifurcationKit.jl doesn&#39;t offer a (public) interface to find &quot;just the limit cycle at a single parameter&quot; like Attractors.jl does, we can&#39;t use it to detect when chaos starts by utilizing a <code>for</code> loop and stopping at the first parameter where the Newton algorithm fails to converge. We have to manually scan the parameter axis and evolve various initial conditions with random sampling and then &quot;look&quot; at the trajectories to see if they are chaotic or not (or, use a tool from DynamicalSystems.jl like <code>lyapunov</code>).</p><h2 id="Attractors.jl-version"><a class="docs-heading-anchor" href="#Attractors.jl-version">Attractors.jl version</a><a id="Attractors.jl-version-1"></a><a class="docs-heading-anchor-permalink" href="#Attractors.jl-version" title="Permalink"></a></h2><p>We have already seen the code for this version in the main Tutorial, but here we copy it again using exactly the same input as that given to BK. To make the comparison explicit, let&#39;s also make an enumerated list for the Attractors.jl info:</p><ol><li>A <code>DynamicalSystem</code>,</li><li>an <code>AttractorMapper</code> instance (and its meta parameters). For the mapper used here, <code>AttractorsViaRecurrences</code>, the meta parameters are:<ol><li>A state space tesselation</li><li>A recurrence threshold</li><li>A lost iterations threshold</li></ol></li><li>a global continuation algorithm, and optionally a matcher for it.</li><li>a sampler to sample initial conditions in the state space.</li></ol><pre><code class="language-julia hljs">using Attractors
ds = CoupledODEs(modified_lorenz_rule!, u0, p0;
    diffeq = (alg = Vern9(), abstol = 1e-9, reltol = 1e-9)
)

grid = (
    range(-15.0, 15.0; length = 100), # x
    range(-20.0, 20.0; length = 100), # y
    range(-20.0, 20.0; length = 100), # z
)

mapper = AttractorsViaRecurrences(ds, grid;
    consecutive_recurrences = 1000,
    consecutive_lost_steps = 100,
)

sampler, = statespace_sampler(grid)

algo = AttractorSeedContinueMatch(mapper)

fractions_cont, attractors_cont = global_continuation(
	algo, prange, pidx, sampler; samples_per_parameter = 1_000
)</code></pre><p>This code takes about 15 seconds to run. Of course, the above code didn&#39;t find and continue just a single limit cycle. It found all system attractors, and it didn&#39;t require a specific initial condition as a guess, or a period, but rather an arbitrarily large box that may contain attractors. Not only only that, but some of the found attractors are <em>chaotic</em>!</p><p>The code is relatively agnostic to the dynamical system as well, meaning, the algorithms are robust: the recurrences mapper would work for most systems with these parameters; it doesn&#39;t need as much tuning (see (<a href="../references/#Datseris2022">Datseris and Wagemakers, 2022</a>) for a proof of that). And furthermore, it estimates a more general nonlocal measure of stability, in the sense that if a set is nonlocally stable, it is guaranteed to be locally stable, however the other way around isn&#39;t guaranteed.</p><p>Now, this example is one that definitely we Attractors.jl is much more suitable for. But to be transparent and discuss the silver linings, BK can do some things not possible (yet) with Attractors.jl, such find the unstable branches of fixed points and limit cycles (in simpler example systems than the one here). Now, whether the unstable branches are useful or not, depends on the research question. Beyond this however, BK is also optimised for PDE systems, while Attractors.jl isn&#39;t. A more thorough comparison of the two approaches (that was based on and older and less powerful version of Attractors.jl) is discussed in (<a href="../references/#Datseris2023">Datseris <em>et al.</em>, 2023</a>).</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/">« Examples for Attractors.jl</a><a class="docs-footer-nextpage" href="../references/">References »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Thursday 4 July 2024 14:37">Thursday 4 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
